---
// BackToTop.astro - Shared back to top button component
---

<button
  id="back-to-top"
  class="fixed bottom-6 right-6 w-11 h-11 rounded-full bg-[var(--bg-surface)] border border-[var(--border)] text-[var(--text-secondary)] hover:bg-[var(--accent)] hover:text-white hover:border-[var(--accent)] transition-all opacity-0 pointer-events-none z-50 shadow-lg hover:shadow-xl backdrop-blur-sm hover:scale-110"
  style="box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.3), 0 4px 6px -2px rgba(0, 0, 0, 0.2);"
  aria-label="Back to top"
>
  <svg
    class="w-5 h-5 mx-auto"
    fill="none"
    stroke="currentColor"
    viewBox="0 0 24 24"
  >
    <path
      stroke-linecap="round"
      stroke-linejoin="round"
      stroke-width="2.5"
      d="M5 10l7-7m0 0l7 7m-7-7v18"></path>
  </svg>
</button>

<script is:inline>
  (function () {
    function setupBackToTop() {
      const backToTopButton = document.getElementById('back-to-top');
      if (!backToTopButton || backToTopButton.dataset.setup) return;
      backToTopButton.dataset.setup = 'true';

      function toggleBackToTop() {
        if (window.scrollY > 300) {
          backToTopButton.style.opacity = '1';
          backToTopButton.style.pointerEvents = 'auto';
        } else {
          backToTopButton.style.opacity = '0';
          backToTopButton.style.pointerEvents = 'none';
        }
      }

      function scrollToTop() {
        window.scrollTo({
          top: 0,
          behavior: 'smooth',
        });
      }

      window.addEventListener('scroll', toggleBackToTop, { passive: true });
      backToTopButton.addEventListener('click', scrollToTop);

      toggleBackToTop();
    }

    // Run immediately and on View Transitions navigation
    setupBackToTop();
    document.addEventListener('astro:page-load', setupBackToTop);
  })();
</script>
